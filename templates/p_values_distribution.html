{% extends "common/base.html" %}

{% block css %}
<style type="text/css">
	ul,li { 
		padding:0;
		margin:0;
		list-style:none;
	}
	a {
		text-decoration: none;
	}
	#content {
		min-height: 600px;
	}
	.title {
		text-align: center;
		margin-top: 80px;
	}
	.title h1 {
		font-size: 2em;
		font-weight: bold;
	}
	.parameters {
		text-align: center;
		font-size: 1.1em;
		margin-top: 20px;
	}
	.remarks {
		width: 50%;
		margin: 0 auto;
	}
	#content {
		color: #FFF;
	}
	#content .siderNavList {
		position: fixed;
		top: 200px;
		left: 0px;
		width: 260px;
		margin-right: 200px;
	}
	#content .resultContainer {
		margin-top: 50px;
		margin-left: 260px;
	}
	.pValueContainer {
		margin-top: 50px;
		font-size: 1.1em;
		font-weight: bold;
	}
	.panel-primary .list-group-item.current
	{
		color: #FFF;
		background-color: #8B7D7B;
	}
	.panel a.list-group-item.current:hover, a.list-group-item.current:focus
	{
		color: #000;
	}
	#headingOne a {
		text-decoration: none;
	}
	#headingTwo a {
		text-decoration: none;
	}
	#headingOne a:hover {
		color: #dab2a6;
	}
	#headingTwo a:hover {
		color: #dab2a6;
	}
	.row {
		margin-top: 20px;
	}
</style>
{% endblock %}

{% block content %}
<div id="content">
	<div class="title">
		<h1>General Results — Distribution of <i>P-values</i></h1>
	</div>
	<div class="parameters">
		<span>Amount of Sequences：{{ amount }}&nbsp;&nbsp;&nbsp;</span>
		<span>Length of a Sequence：{{ length }}&nbsp;&nbsp;&nbsp;</span>
		<span>Significant Level：{{ alpha }}</span>
	</div>
	<div class="remarks" style="margin-top: 30px; margin-bottom: -20px;">
		<div class="panel panel-warning" style="background: #8B795E;">
			<div class="panel-heading" style="text-align: center; font-weight: bold;">Remarks</div>
			<table class="table table-bordered">
				<tbody>
					<tr>
						<th scope="row">1</th>
						<td>The interval between 0 and 1 is divided into 10 sub-intervals uniformly as C1 to C10.</td>
					</tr>
					<tr>
						<th scope="row">2</th>
						<td>The <i>P-values</i> of each test lie within the corresponding sub-interval.</td>
					</tr>
					<tr>
						<th scope="row">3</th>
						<td>The <i>P-value<sub>T</sub></i> denotes the goodness-of-fit of the distribution of <i>P-values</i> and uniform distribution.</td>
					</tr>
					<tr>
						<th scope="row">4</th>
						<td>If <i>P-value<sub>T</sub></i> ≥ 0.0001, the test sequences can be considered to be uniformly distributed.</td>
					</tr>
					<tr>
						<th scope="row">5</th>
						<td>At least 55 sequences should be processed in order to generate statistically meaningful results.</td>
					</tr>
				</tbody>
			</table>
		</div>
	</div>
	<div class="siderNavList">
		<div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
			<div class="panel panel-primary" style="background: #1a100a; border-color: #1a100a;">
				<div class="panel-heading" role="tab" id="headingOne" style="background: #1a100a; border-color: #1a100a;">
					<h4 class="panel-title">
						<a role="button" data-toggle="collapse" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
							General Results&nbsp;&nbsp;<span class="caret"></span>
						</a>
					</h4>
				</div>
				<div id="collapseOne" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
					<ul class="list-group">
						<li>
							<a href="/result/pass_rate" class="list-group-item">
								Pass Rate&nbsp;<span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span>
							</a>
						</li>
						<li>
							<a href="javascript:;" class="list-group-item current">
								Distribution of <i>P-values</i>&nbsp;<span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span>
							</a>
						</li>
						<li>
							<a href="javascript:;" class="list-group-item">
								Characters Proportion&nbsp;<span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span>
							</a>
						</li>
					</ul>
				</div>
			</div>
			<div class="panel panel-primary" style="background: #1a100a; border-color: #1a100a;">
				<div class="panel-heading" role="tab" id="headingTwo" style="background: #1a100a; border-color: #1a100a;">
				<h4 class="panel-title">
					<a class="collapsed" role="button" data-toggle="collapse" href="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
						Process Analysis&nbsp;&nbsp;<span class="caret"></span>
					</a>
				</h4>
				</div>
				<div id="collapseTwo" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingTwo">
					<ul class="list-group">
						<li>
							<a href="javascript:;" class="list-group-item">
								Frequency Test&nbsp;<span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span>
							</a>
						</li>
						<li>
							<a href="javascript:;" class="list-group-item">
								Frequency Test within a Block&nbsp;<span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span>
							</a>
						</li>
						<li>
							<a href="javascript:;" class="list-group-item">
								Runs Test&nbsp;<span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span>
							</a>
						</li>
						<li>
							<a href="javascript:;" class="list-group-item">
								Test for the Longest Run of Ones&nbsp;<span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span>
							</a>
						</li>
					</ul>
				</div>
			</div>
		</div>
	</div>

	<div class="resultContainer">
		<div class="row" id="container-1">
			<div class="col-sm-8 text-center">
				<div id="frequencyTest" style="width: 600px;height:400px;"></div>
			</div>
			<div class="col-sm-4 text-left">
				<div class="pValueContainer">
					<p><i>P-value<sub>T</sub></i> ：{{ "%.5f" % p_value_distribution["frequency"][10] }}</p>
					{% if p_value_distribution["frequency"][10]>=0.0001 %}
						<p>Indication ：Success</p>
					{% else %}
						<p>Indication ：Failure</p>
					{% endif %}
				</div>
			</div>
		</div>
		<div class="row" id="container-2">
			<div class="col-sm-8 text-center">
				<div id="frequency" style="width: 600px;height:400px;"></div>
			</div>
			<div class="col-sm-4 text-left">
				<div class="pValueContainer">
					<p><i>P-value<sub>T</sub></i> ：{{ "%.5f" % p_value_distribution["frequency_within_a_block"][10] }}</p>
					{% if p_value_distribution["frequency_within_a_block"][10]>=0.0001 %}
						<p>Indication ：Success</p>
					{% else %}
						<p>Indication ：Failure</p>
					{% endif %}
				</div>
			</div>
		</div>
		<div class="row" id="container-3">
			<div class="col-sm-8 text-center">
				<div id="runs" style="width: 600px;height:400px;"></div>
			</div>
			<div class="col-sm-4 text-left">
				<div class="pValueContainer">
					<p><i>P-value<sub>T</sub></i> ：{{ "%.5f" % p_value_distribution["runs"][10] }}</p>
					{% if p_value_distribution["runs"][10]>=0.0001 %}
						<p>Indication ：Success</p>
					{% else %}
						<p>Indication ：Failure</p>
					{% endif %}
				</div>
			</div>
		</div>
		<div class="row" id="container-4">
			<div class="col-sm-8 text-center">
				<div id="longestRun" style="width: 600px;height:400px;"></div>
			</div>
			<div class="col-sm-4 text-left">
				<div class="pValueContainer">
					<p><i>P-value<sub>T</sub></i> ：{{ "%.5f" % p_value_distribution["longest_run_of_ones"][10] }}</p>
					{% if p_value_distribution["longest_run_of_ones"][10]>=0.0001 %}
						<p>Indication ：Success</p>
					{% else %}
						<p>Indication ：Failure</p>
					{% endif %}
				</div>
			</div>
		</div>
	</div>
</div>
{% endblock %}

{% block js %}
<script src="{{ url_for('static', filename='js/jquery.js') }}"></script>
<script src="{{ url_for('static', filename='js/bootstrap.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/echarts.min.js') }}"></script>

<script type="text/javascript">
	var p_value_dict = JSON.parse('{{ p_value_distribution|tojson }}');
	var frequencyTestChart = echarts.init(document.getElementById('frequencyTest'));
	var blockFrequencyTestChart = echarts.init(document.getElementById('frequency'));
	var runsChart = echarts.init(document.getElementById('runs'));
	var longestRunChart = echarts.init(document.getElementById('longestRun'));

	// Set up the coordinate parameters for each test
	var frequencyTestOption = {
		color: ['#CD7054'],
		title: {
			text: 'No.1 Frequency Test',
			textStyle: {
				color: '#FFF68F'
			},
		},
		tooltip: {
			trigger: 'axis',
			axisPointer: {
				type: 'shadow'
			}
		},
		xAxis: {
			name: 'Intervals',
			nameLocation: 'center',
			nameGap: 30,
			nameTextStyle: {
				fontSize: 14
			},
			data : ["C1", "C2", "C3", "C4", "C5", "C6", "C7", "C8", "C9", "C10"],
			axisTick: {
				alignWithLabel: true
			},
			axisLine: {
				lineStyle:{
					color:'#FFF'
				}
			},
			axisLabel: {
				textStyle: {
					color: '#FFF'
				}
			}
		},
		yAxis: {
			name: 'Frequency Counts',
			nameLocation: 'center',
			nameGap: 40,
			nameTextStyle: {
				fontSize: 14
			},
			axisLine: {
				lineStyle:{
					color:'#FFF'
				}
			},
			axisLabel: {
				textStyle: {
					color: '#FFF'
				}
			}
		},
		series: {
			name: 'Number',
			type: 'bar',
			data: p_value_dict['frequency'].slice(0,10)
		}
	};
	var blockFrequencyTestOption = {
		color: ['#CD7054'],
		title: {
			text: 'No.2 Frequency Test within a Block',
			textStyle: {
				color: '#FFF68F'
			},
		},
		tooltip: {
			trigger: 'axis',
			axisPointer: {
				type: 'shadow'
			}
		},
		xAxis: {
			name: 'Intervals',
			nameLocation: 'center',
			nameGap: 30,
			nameTextStyle: {
				fontSize: 14
			},
			data : ["C1", "C2", "C3", "C4", "C5", "C6", "C7", "C8", "C9", "C10"],
			axisTick: {
				alignWithLabel: true
			},
			axisLine: {
				lineStyle: {
					color:'#FFF'
				}
			},
			axisLabel: {
				textStyle: {
					color: '#FFF'
				}
			}
		},
		yAxis: {
			name: 'Frequency Counts',
			nameLocation: 'center',
			nameGap: 40,
			nameTextStyle: {
				fontSize: 14
			},
			axisLine: {
				lineStyle: {
					color:'#FFF'
				}
			},
			axisLabel: {
				textStyle: {
					color: '#FFF'
				}
			}
		},
		series: {
			name: 'Number',
			type: 'bar',
			data: p_value_dict['frequency_within_a_block'].slice(0,10)
		}
	};
	var runsOption = {
		color: ['#CD7054'],
		title: {
			text: 'No3. Runs Test',
			textStyle: {
				color: '#FFF68F'
			},
		},
		tooltip: {
			trigger: 'axis',
			axisPointer: {
				type: 'shadow'
			}
		},
		xAxis: {
			name: 'Intervals',
			nameLocation: 'center',
			nameGap: 30,
			nameTextStyle: {
				fontSize: 14
			},
			data : ["C1", "C2", "C3", "C4", "C5", "C6", "C7", "C8", "C9", "C10"],
			axisTick: {
				alignWithLabel: true
			},
			axisLine: {
				lineStyle: {
					color:'#FFF'
				}
			},
			axisLabel: {
				textStyle: {
					color: '#FFF'
				}
			}
		},
		yAxis: {
			name: 'Frequency Counts',
			nameLocation: 'center',
			nameGap: 40,
			nameTextStyle: {
				fontSize: 14
			},
			axisLine: {
				lineStyle: {
					color:'#FFF'
					}
			},
			axisLabel: {
				textStyle: {
					color: '#FFF'
				}
			}
		},
		series: {
			name: 'Number',
			type: 'bar',
			data: p_value_dict['runs'].slice(0,10)
		}
	};
	var longestRunOption = {
		color: ['#CD7054'],
		title: {
			text: 'No.4 Test for the Longest Run of Ones',
			textStyle: {
				color: '#FFF68F'
			},
		},
		tooltip: {
			trigger: 'axis',
			axisPointer: {
				type: 'shadow'
			}
		},
		xAxis: {
			name: 'Intervals',
			nameLocation: 'center',
			nameGap: 30,
			nameTextStyle: {
				fontSize: 14
			},
			data : ["C1", "C2", "C3", "C4", "C5", "C6", "C7", "C8", "C9", "C10"],
			axisTick: {
				alignWithLabel: true
			},
			axisLine: {
				lineStyle: {
					color:'#FFF'
				}
			},
			axisLabel: {
				textStyle: {
					color: '#FFF'
				}
			}
		},
		yAxis: {
			name: 'Frequency Counts',
			nameLocation: 'center',
			nameGap: 40,
			nameTextStyle: {
				fontSize: 14
			},
			axisLine: {
				lineStyle: {
					color:'#FFF'
				}
			},
			axisLabel: {
				textStyle: {
					color: '#FFF'
				}
			}
		},
		series: {
			name: 'Number',
			type: 'bar',
			data: p_value_dict['longest_run_of_ones'].slice(0,10)
		}
	};
	frequencyTestChart.setOption(frequencyTestOption);
	blockFrequencyTestChart.setOption(blockFrequencyTestOption);
	runsChart.setOption(runsOption);
	longestRunChart.setOption(longestRunOption);

	// Hide the result display of such tests which are not selected
	var isSelected = JSON.parse('{{ is_selected|tojson }}');
	if (!isSelected['frequencyTest']) 
		document.getElementById("container-1").style.display = "none";
	if (!isSelected['frequencyTestWithinABlock']) 
		document.getElementById("container-2").style.display = "none";
	if (!isSelected['runsTest']) 
		document.getElementById("container-3").style.display = "none";
	if (!isSelected['longestRunOfOnes']) 
		document.getElementById("container-4").style.display = "none";

</script>
{% endblock %}